<?xml version = '1.0' encoding = 'UTF-8'?>
<PackageOracle class="oracle.dbtools.crest.model.design.storage.oracle.PackageOracle" name="PKG_OSB_SERVICE" directorySegmentName="seg_6" id="78EEA62C-60D1-66FB-32D6-4332874A1820">
<sourceConnName>SOLO_Prod</sourceConnName>
<sourceObjSchema>CHTR</sourceObjSchema>
<sourceObjName>PKG_OSB_SERVICE</sourceObjName>
<createdBy>jandrews1</createdBy>
<createdTime>2015-08-11 13:17:23 UTC</createdTime>
<ownerDesignName>SOLO_DECEMBER_RE</ownerDesignName>
<owner>5AF9E3FC-7A76-C437-3E83-BF29D7EA2FC7</owner>
<source>CREATE OR REPLACE PACKAGE CHTR.PKG_OSB_SERVICE&lt;br/&gt;/****************************************************************************************************************&lt;br/&gt;||  Program Name    : pkg_osb_service&lt;br/&gt;||  Created By      : Knoll&lt;br/&gt;||  Created Date    : 01-Feb-2015&lt;br/&gt;||  Subject Area    : Provisioning&lt;br/&gt;||  Description     : To be used by OSB Webservice&lt;br/&gt;||&lt;br/&gt;||   Change log:&lt;br/&gt;||&lt;br/&gt;||    Changed By            Changed On               Change Description&lt;br/&gt;||  -------------------------------------------------------------------------------------------------------------&lt;br/&gt;||    Venkat                10-Apr-2015              Walled Garden Project Change.&lt;br/&gt;||                                                      Added new function verify_walled_garden_routing&lt;br/&gt;******************************************************************************************************************/&lt;br/&gt;AS&lt;br/&gt;   TYPE ref_cur_type IS REF CURSOR;&lt;br/&gt;&lt;br/&gt;   PROCEDURE enqueue_equipment_change (&lt;br/&gt;      p_request_creation_date    IN   DATE,&lt;br/&gt;      p_billing_account_number   IN   VARCHAR2&lt;br/&gt;   );&lt;br/&gt;&lt;br/&gt;   FUNCTION verify_walled_garden_routing (&lt;br/&gt;      in_audit_user    IN   VARCHAR2,&lt;br/&gt;      in_account_num   IN   VARCHAR2&lt;br/&gt;   )&lt;br/&gt;      RETURN VARCHAR2;&lt;br/&gt;END pkg_osb_service;</source>
<body class="oracle.dbtools.crest.model.design.storage.oracle.PackageBodyOracle" name="PKG_OSB_SERVICE" id="78EEA62C-60D1-66FB-32D6-4332874A1820">
<sourceConnName>SOLO_Prod</sourceConnName>
<sourceObjSchema>CHTR</sourceObjSchema>
<sourceObjName>PKG_OSB_SERVICE</sourceObjName>
<createdBy>jandrews1</createdBy>
<createdTime>2015-08-11 13:17:23 UTC</createdTime>
<ownerDesignName>SOLO_DECEMBER_RE</ownerDesignName>
<owner>5AF9E3FC-7A76-C437-3E83-BF29D7EA2FC7</owner>
<source>CREATE OR REPLACE PACKAGE BODY CHTR.PKG_OSB_SERVICE&lt;br/&gt;AS&lt;br/&gt;/****************************************************************************************************************&lt;br/&gt;||  Program Name    : pkg_osb_service&lt;br/&gt;||  Created By      : Knoll&lt;br/&gt;||  Created Date    : 01-Feb-2015&lt;br/&gt;||  Subject Area    : Provisioning&lt;br/&gt;||  Description     : To be used by OSB Webservice&lt;br/&gt;||&lt;br/&gt;||   Change log:&lt;br/&gt;||&lt;br/&gt;||    Changed By            Changed On               Change Description&lt;br/&gt;||  -------------------------------------------------------------------------------------------------------------&lt;br/&gt;||    Venkat                10-Apr-2015              Walled Garden Project Change.&lt;br/&gt;||                                                      Added new function verify_walled_garden_routing&lt;br/&gt;******************************************************************************************************************/&lt;br/&gt;&lt;br/&gt;   PROCEDURE enqueue_equipment_change (&lt;br/&gt;      p_request_creation_date    IN   DATE,&lt;br/&gt;      p_billing_account_number   IN   VARCHAR2&lt;br/&gt;   )&lt;br/&gt;   AS&lt;br/&gt;      r_enqueue_options      DBMS_AQ.enqueue_options_t;&lt;br/&gt;      r_message_properties   DBMS_AQ.message_properties_t;&lt;br/&gt;      v_message_handle       RAW (16);&lt;br/&gt;      o_payload              equipment_change_qtype;&lt;br/&gt;   BEGIN&lt;br/&gt;      -- Build our message to put on AQ.&lt;br/&gt;      o_payload :=&lt;br/&gt;         equipment_change_qtype&lt;br/&gt;                          (request_creation_date       =&gt; p_request_creation_date,&lt;br/&gt;                           billing_account_number      =&gt; p_billing_account_number&lt;br/&gt;                          );&lt;br/&gt;      -- Put the message on the queue.&lt;br/&gt;      DBMS_AQ.enqueue (queue_name              =&gt; &apos;chtr.equipment_change_q&apos;,&lt;br/&gt;                       enqueue_options         =&gt; r_enqueue_options,&lt;br/&gt;                       message_properties      =&gt; r_message_properties,&lt;br/&gt;                       payload                 =&gt; o_payload,&lt;br/&gt;                       msgid                   =&gt; v_message_handle&lt;br/&gt;                      );&lt;br/&gt;   EXCEPTION&lt;br/&gt;      WHEN OTHERS&lt;br/&gt;      THEN&lt;br/&gt;         pkg_logging.log_exception (   &apos;account_number=&apos;&lt;br/&gt;                                    || p_billing_account_number&lt;br/&gt;                                    || &apos;exception=&apos;&lt;br/&gt;                                    || DBMS_UTILITY.format_error_stack ()&lt;br/&gt;                                   );&lt;br/&gt;   END enqueue_equipment_change;&lt;br/&gt;&lt;br/&gt;   FUNCTION verify_walled_garden_routing (&lt;br/&gt;      in_audit_user    IN   VARCHAR2,&lt;br/&gt;      in_account_num   IN   VARCHAR2&lt;br/&gt;   )&lt;br/&gt;   /****************************************************************************************************************&lt;br/&gt;   ||  SubProgram Name    : verify_walled_garden_routing&lt;br/&gt;   ||  Estimated Run Time :&lt;br/&gt;   ||  Description        : Verify the account is eligible to route it to Walled Garden based on Dunning Group&lt;br/&gt;   ****************************************************************************************************************/&lt;br/&gt;      RETURN VARCHAR2&lt;br/&gt;   IS&lt;br/&gt;      l_status   VARCHAR2 (100) := &apos;Unknown&apos;;&lt;br/&gt;   BEGIN&lt;br/&gt;      BEGIN&lt;br/&gt;         SELECT DECODE (NVL (walled_garden_flag, &apos;N&apos;),&lt;br/&gt;                        &apos;Y&apos;, &apos;Verified&apos;,&lt;br/&gt;                        &apos;Not Verified&apos;&lt;br/&gt;                       )&lt;br/&gt;           INTO l_status&lt;br/&gt;           FROM t_account_vantage_xref xref INNER JOIN t_account acc&lt;br/&gt;                ON acc.account_id = xref.account_id&lt;br/&gt;                LEFT OUTER JOIN t_dunning_group_cd dun&lt;br/&gt;                ON dun.dunning_group_cd = acc.dunning_group_cd&lt;br/&gt;          WHERE xref.sub_acct_num = in_account_num;&lt;br/&gt;      EXCEPTION&lt;br/&gt;         WHEN NO_DATA_FOUND&lt;br/&gt;         THEN&lt;br/&gt;            pkg_logging.log_exception (   &apos;account_number=&apos;&lt;br/&gt;                                    || in_account_num&lt;br/&gt;                                    || &apos; - Not exist&apos;&lt;br/&gt;                                   );&lt;br/&gt;         WHEN OTHERS&lt;br/&gt;         THEN&lt;br/&gt;          pkg_logging.log_exception (   &apos;account_number=&apos;&lt;br/&gt;                                    || in_account_num&lt;br/&gt;                                    || &apos;exception=&apos;&lt;br/&gt;                                    || DBMS_UTILITY.format_error_stack ()&lt;br/&gt;                                   );&lt;br/&gt;      END;&lt;br/&gt;&lt;br/&gt;      RETURN l_status;&lt;br/&gt;   END verify_walled_garden_routing;&lt;br/&gt;END pkg_osb_service;</source>
</body>
</PackageOracle>